; Listing generated by Microsoft (R) Optimizing Compiler Version 18.00.31101.0 

	TITLE	C:\Users\DAVE\Documents\Programming\Visual_Studio_6\EXE\Console\SoundOff\SoundOff\SOff_ReportLoadStringError.C
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

EXTRN	__imp__FB_GetSprintFBufferW:PROC
EXTRN	__imp__FB_LoadStringW:PROC
EXTRN	__imp__SetLastError@4:PROC
EXTRN	__imp__GetLastError@0:PROC
EXTRN	__imp__FB_FormatMessage2W:PROC
EXTRN	__imp__wprintf:PROC
EXTRN	__imp___swprintf:PROC
EXTRN	__imp__FB_FormatMessageW:PROC
EXTRN	__imp__FB_GetlpResourceBufferW:PROC
PUBLIC	_SOff_ReportLoadStringError@12
; Function compile flags: /Ogtp
; File c:\users\dave\documents\programming\visual_studio_6\exe\console\soundoff\soundoff\soff_reportloadstringerror.c
;	COMDAT _SOff_ReportLoadStringError@12
_TEXT	SEGMENT
_puintBufferID$dead$ = 8				; size = 4
_SOff_ReportLoadStringError@12 PROC			; COMDAT
; _phSourceModule$dead$ = ecx
; _puintStringID$ = edx

; 9    : {

	push	esi
	push	edi
	mov	esi, edx

; 10   : 	DWORD dwStatus = GetLastError ( ) ;

	call	DWORD PTR __imp__GetLastError@0
	mov	edi, eax

; 11   : 
; 12   : 	if ( dwStatus )

	test	edi, edi
	je	SHORT $LN3@SOff_Repor

; 13   : 	{
; 14   : 		if ( FB_LoadFixedString_DfltBuf ( IDS_STRING_LOAD_ERROR_1 ) )

	push	0
	push	0
	push	106					; 0000006aH
	push	0
	call	DWORD PTR __imp__FB_LoadStringW
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN6@SOff_Repor

; 15   : 		{
; 16   : 			_stprintf ( FB_GetSprintFBuffer ( FB_FIRST_BUFFER_INDEX ) ,
; 17   : 				        FB_GetlpResourceBuffer ( FB_FIRST_BUFFER_INDEX ) ,
; 18   : 				        puintStringID ) ;

	push	esi
	mov	esi, DWORD PTR __imp__FB_GetlpResourceBufferW
	push	0
	call	esi
	add	esp, 4
	push	eax
	push	0
	call	DWORD PTR __imp__FB_GetSprintFBufferW
	add	esp, 4
	push	eax
	call	DWORD PTR __imp___swprintf
	add	esp, 12					; 0000000cH

; 19   : 			_tprintf ( FB_FormatMessage ( FB_GetlpResourceBuffer ( FB_FIRST_BUFFER_INDEX ) ,
; 20   : 				                          dwStatus ,
; 21   : 				                          SCF2_HEXADECIMAL ) ) ;

	push	0
	push	edi
	push	0
	call	esi
	add	esp, 4
	push	eax
	call	DWORD PTR __imp__FB_FormatMessageW
	push	eax
	call	DWORD PTR __imp__wprintf

; 28   : 		_tprintf ( FB_FormatMessage2 ( IDS_STRING_LOAD_ERROR_2 ,
; 29   :   			                           dwStatus ,
; 30   : 				                       SCF2_HEXADECIMAL ) ) ;

	add	esp, 16					; 00000010H

; 31   : 	}   // FALSE block, if ( dwStatus )
; 32   : 
; 33   : 	//	------------------------------------------------------------------------
; 34   : 	//	Raise a structured exception if the SEH flag is set. When this happens,
; 35   : 	//	there is no actual return, and the stack is unwound.
; 36   : 	//	------------------------------------------------------------------------
; 37   : 
; 38   : 	return dwStatus ;	// Tell the calling routine to call GetLastError and/or FB_GetlpErrMsgSprintf (to get the message).

	mov	eax, edi
	pop	edi
	pop	esi

; 39   : }	// SOff_ReportLoadStringError

	ret	4
$LN6@SOff_Repor:

; 31   : 	}   // FALSE block, if ( dwStatus )
; 32   : 
; 33   : 	//	------------------------------------------------------------------------
; 34   : 	//	Raise a structured exception if the SEH flag is set. When this happens,
; 35   : 	//	there is no actual return, and the stack is unwound.
; 36   : 	//	------------------------------------------------------------------------
; 37   : 
; 38   : 	return dwStatus ;	// Tell the calling routine to call GetLastError and/or FB_GetlpErrMsgSprintf (to get the message).

	mov	eax, edi
	pop	edi
	pop	esi

; 39   : }	// SOff_ReportLoadStringError

	ret	4
$LN3@SOff_Repor:

; 22   : 		}   // if ( FB_LoadFixedString_DfltBuf ( IDS_STRING_LOAD_ERROR_1 ) )
; 23   : 	}   // TRUE block, if ( dwStatus )
; 24   : 	else
; 25   : 	{	// Since Windows provided no error, we supply our own.
; 26   : 		dwStatus = FB_ERR_STRNG_NOT_FOUND_FOR_ID ;
; 27   : 		SetLastError ( dwStatus );

	push	537002000				; 20020010H
	call	DWORD PTR __imp__SetLastError@4

; 28   : 		_tprintf ( FB_FormatMessage2 ( IDS_STRING_LOAD_ERROR_2 ,
; 29   :   			                           dwStatus ,
; 30   : 				                       SCF2_HEXADECIMAL ) ) ;

	push	0
	push	537002000				; 20020010H
	push	107					; 0000006bH
	call	DWORD PTR __imp__FB_FormatMessage2W
	push	eax
	call	DWORD PTR __imp__wprintf
	add	esp, 16					; 00000010H

; 31   : 	}   // FALSE block, if ( dwStatus )
; 32   : 
; 33   : 	//	------------------------------------------------------------------------
; 34   : 	//	Raise a structured exception if the SEH flag is set. When this happens,
; 35   : 	//	there is no actual return, and the stack is unwound.
; 36   : 	//	------------------------------------------------------------------------
; 37   : 
; 38   : 	return dwStatus ;	// Tell the calling routine to call GetLastError and/or FB_GetlpErrMsgSprintf (to get the message).

	mov	eax, 537002000				; 20020010H
	pop	edi
	pop	esi

; 39   : }	// SOff_ReportLoadStringError

	ret	4
_SOff_ReportLoadStringError@12 ENDP
_TEXT	ENDS
END
